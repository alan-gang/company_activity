<!DOCTYPE html>
<html>
<head>
	<meta name="renderer" content="webkit">
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta HTTP-EQUIV="pragma" CONTENT="no-cache">
	<meta HTTP-EQUIV="Cache-Control" CONTENT= "no-cache, must-revalidate">
    <title>每日任务</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
	<link rel="stylesheet" type="text/css" href="css/dailytask.css">
	<link rel="stylesheet" type="text/css" href="css/popup.css">
</head>

<body>
	<div class="wrapper w1">
		<div class="banner w1">
		</div>
		<div class="content w1">
			<div style="text-align: center"><img src="img/dailytask/title01.png" alt=""></div>
			<ul class="list">
				<li class="fl">
					<div class="taskLevel w1 tac fz18">任务1</div>
					<div class="taskIcon w1 tac">
						<img src="img/dailytask/icon01.png" alt="">
					</div>
					<div class="taskInfo1 w1 tac fz16 cf">每日签到</div>
					<div class="taskInfo2 w1 tac fz16 cf"></div>
					<div class="taskLevel w1 tac fz16">+ 38 U币 </div>
					<div class="goGet w1 tac">
						<button class="w1 fz16 tac" href="javascript:" title="">
							未达标
						</button>
					</div>
				</li>
				<li class="fl">
					<div class="taskLevel w1 tac fz18">任务2</div>
					<div class="taskIcon w1 tac">
						<img src="img/dailytask/icon02.png" alt="">
					</div>
					<div class="taskInfo1 w1 tac fz16 cf">每日竞猜投注</div>
					<div class="taskInfo2 w1 tac fz16 cf">累计<i class="num">20</i>次</div>
					<div class="taskLevel w1 tac fz16">+ 58 U币 </div>
					<div class="goGet w1 tac">
						<button class="w1 fz16 tac" href="javascript:" title="">
							未达标
						</button>
					</div>
				</li>
				<li class="fl">
					<div class="taskLevel w1 tac fz18">任务3</div>
					<div class="taskIcon w1 tac">
						<img src="img/dailytask/icon03.png" alt="">
					</div>
					<div class="taskInfo1 w1 tac fz16 cf">每日竞猜投注</div>
					<div class="taskInfo2 w1 tac fz16 cf">金额累计<i class="num">1888</i>元</div>
					<div class="taskLevel w1 tac fz16">+ 88 U币 </div>
					<div class="goGet w1 tac">
						<button class="w1 fz16 tac" href="javascript:" title="">
							未达标
						</button>
					</div>
				</li>
				<li class="fl">
					<div class="taskLevel w1 tac fz18">任务4</div>
					<div class="taskIcon w1 tac">
						<img src="img/dailytask/icon04.png" alt="">
					</div>
					<div class="taskInfo1 w1 tac fz16 cf">每日充值金额</div>
					<div class="taskInfo2 w1 tac fz16 cf">累计>=<i class="num">2888</i>元</div>
					<div class="taskLevel w1 tac fz16">+ 688 U币 </div>
					<div class="goGet w1 tac">
						<button class="w1 fz16 tac" href="javascript:" title="">
							未达标
						</button>
					</div>
				</li>
				<li class="fl">
					<div class="taskLevel w1 tac fz18">任务5</div>
					<div class="taskIcon w1 tac">
						<img src="img/dailytask/icon05.png" alt="">
					</div>
					<div class="taskInfo1 w1 tac fz16 cf">每日充值金额</div>
					<div class="taskInfo2 w1 tac fz16 cf">累计>=<i class="num">5888</i>元</div>
					<div class="taskLevel w1 tac fz16">+ 1888 U币 </div>
					<div class="goGet w1 tac">
						<button class="w1 fz16 tac" href="javascript:" title="">
							未达标
						</button>
					</div>
				</li>
				<li class="fl">
					<div class="taskLevel w1 tac fz18">任务6</div>
					<div class="taskIcon w1 tac">
						<img src="img/dailytask/icon06.png" alt="">
					</div>
					<div class="taskInfo1 w1 tac fz16 cf">完成当日所有任务</div>
					<div class="taskInfo2 w1 tac fz16 cf"></div>
					<div class="taskLevel w1 tac fz16">+ 888 U币 </div>
					<div class="goGet w1 tac">
						<button class="w1 fz16 tac" href="javascript:" title="">
							未达标
						</button>
					</div>
				</li>
			</ul>
			<div class="actTerm">
				<div class="termTitle"><img src="img/dailytask/title02.png" alt=""></div>
				<ul class="termList mat">
					<li>
						<i class="termIndex">1</i>用户每天可完成5次系统任务，完成任务可领取对应奖励；
					</li>
					<li>
						<i class="termIndex">2</i>竞猜投注只限现金投注，任务完成后用户需在活动页面自行领取活动奖励；
					</li>
					<li>
						<i class="termIndex">3</i>活动每天00：00AM重置，未领取奖励用户视为自动放弃领取；
					</li>
					<li>
						<i class="termIndex">4</i>每一名用户同一IP段、同一代理下多批套利者，发现后会批量冻结相关账号。
					</li>
					<li>
						<i class="termIndex">5</i>如发现恶意刷取活动套利者，将扣除红利及所得盈利。
					</li>
					<li>
						<i class="termIndex">6</i>凡参加活动用户，即表示接受且自愿遵守平台规定，平台保留最终解释权。
					</li>
				</ul>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="js/popup.js"></script>
	<script type="text/javascript">
		$(function() {
			if (location.href.indexOf('login=true') != -1) {
				queryDaily();
			}else{
				if ( parent && parent.closeIFrame ) {
		          	parent.closeIFrame({action: 'goLogin'})
		        } else {
		          	if ( location.search != '?goLogin') {
		        		location.search = 'goLogin'
		        	}
		        }
			}
			function queryDaily () {
				$.ajax({
					    url: "/Promos/Detail",
					    jsonp: "callback",
					    // dataType: "jsonp",
					    async: true,
					    data: { "id": "2","a": "query" },    //参数值
					    type: "GET",   //请求方式
					    beforeSend: function() {
					        //请求前的处理
					    },
					    success: function(req) {
					    	console.log(req.data[1].conditions)
					    	var list = req.data;
					    	$.map( list, function(v,i){
					    		$('.list li:nth-child(' + (i+1) +')').find('.num').html( v.conditions );
					    		if ( v.isCan == 0 ) {
						    		$("ul li:eq(" + i + ") .goGet button").html("未达标").removeClass('canSign');
						    	}else if ( v.isCan == 1 ) {
						    		$("ul li:eq(" + i + ") .goGet button").html("立即领取").addClass('canSign');
						    	}else if ( v.isCan == 2 ) {
						    		$("ul li:eq(" + i + ") .goGet button").html("已领取").removeClass('canSign');
						    	}
							});
					    	$(document).on('click', '.canSign', function(){
					    		var $this = this;
					    		var index = parseInt($($this).parent().parent('.list li').index() + 1);
					    		// console.log(index)
						        drawDaily ($this,index);
							});
					    }
					});
			}

			function drawDaily ($this,index) {
				// var $this = this
				$.ajax({
				    url: "/Promos/Detail",
				    jsonp: "callback",
				    // dataType: "jsonp",
				    async: true,
				    data: { "id": "2","a": "draw","t": index },    //参数值
				    type: "GET",   //请求方式
				    beforeSend: function() {
				        //请求前的处理
				    },
				    success: function(req) {
				    	// console.log(req.state)
				    	if ( req.state ) {
						    var popup = new Popup({
						        'type': 'submit',
						        'title': '提示信息',
						        'text': req.data,
						        'submitCallBack': function(){
						            $($this).html("已领取").removeClass('canSign')
						        }
						    })
				    	} else {
						    var popup = new Popup({
						        'type': 'submit',
						        'title': '提示信息',
						        'text': req.message
						    })
				    	}

					}
				});
			}


	    });
	</script>
</body>
</html>
