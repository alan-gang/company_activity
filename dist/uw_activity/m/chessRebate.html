<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>棋牌特权活动 充值即返5‰ 无上限！</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
	<link rel="stylesheet" type="text/css" href="css/chessrebate.css?v=2.0">
	<link rel="stylesheet" type="text/css" href="css/popup.css?v=1">
	<script type="text/javascript" src="js/fastclick.js"></script>
</head>

<body>
	<div class="wrapper w1">
		<div class="banner w1"></div>
		<div class="actTerm w1">
			<div class="bar bar1 w1"></div>
			<div class="btnBar">
				<div id="draw" class="btn btn1 mat openMask">
					立即领取<i class="bonus">0</i><i class="yuan">元</i>奖金
				</div>
				<div id="topUp" class="btn btn2 mat" onclick="back()">
					立即充值
				</div>
			</div>
			<div class="conTitle mat"></div>
			<ul class="termList mat">
				<li>
					<i class="termIndex">1</i>玩家每次充值即可获得5‰奖金回馈，奖金可自行领取；
				</li>
				<li>
					<i class="termIndex">2</i>在充值后领取彩金可以选择添加开元或乐游账户中;
				</li>
				<li>
					<i class="termIndex">3</i>奖金回馈无充值次数限制、无金额上限；
				</li>
			</ul>
			<div class="termTitle mat"></div>
			<ul class="termList mat">
				<li>
					<i class="termIndex">1</i>奖金流水只限棋牌游戏，奖金需完成一倍流水可提现或转出；
				</li>
				<li>
					<i class="termIndex">2</i>如未在棋牌游戏中完成流水要求，将奖金转让其它产品盈利将视为无效；
				</li>
				<li>
					<i class="termIndex">3</i>充值成功后，奖金可自行领取；
				</li>
				<li>
					<i class="termIndex">4</i>每位玩家、每一组电话号码、每一IP、相同支付方式（含相同借记卡，信用卡，银行帐号）只能申请一次；
				</li>
				<li>
					<i class="termIndex">5</i>如发现恶意刷取活动套利者，将扣除红利及所得盈利。
				</li>
				<li>
					<i class="termIndex">6</i>凡参加活动用户，即表示接受且自愿遵守平台规定，平台保留最终解释权。
				</li>
				<!-- <li>
					<i class="timeIndex">活动时间：</i><br>2018年12月30日23:59分-1月18日23:59分
				</li> -->
			</ul>
		</div>

		<!-- 领取弹窗 -->
		<div class="mask">
			<div class="mCon">
				<div class="mTop">
					请点击选择您喜爱的棋牌游戏，并转入彩金<i id="money" class="bonus">0</i>元
				</div>
				<div class="mBot">
					<img id="4" class="cImg a1 draw" src="img/chessrebate/a1_.png" alt="">
					<img id="9" class="cImg a2 draw" src="img/chessrebate/a2_.png" alt="">
				</div>
				<img class="closeMask" src="img/chessrebate/close@2x.png" alt="">
			</div>
		</div>
	</div>
	<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript" src="js/popup.js"></script>
	<script type="text/javascript">
		FastClick.attach(document.body);
		$('.openMask').on('click',function(){
           	$('.mask').css('display','block');
      	});
      	$('.closeMask').on('click',function(){
          	$('.mask').css('display','none');
      	});
	  	var hasLogin = false;
	  	//h5登录
	  	if (location.href.indexOf('type=h5') != -1) {
	      if (location.href.indexOf('hasLogin=true') != -1) {
	        hasLogin = true;
	        query ();
	      }else{
	        if ( parent && parent.closeIFrame ) {
	          parent.closeIFrame({action: 'goLogin'})
	        } else {
	          if ( location.search != '?goLogin') {
	            location.search = 'goLogin'
	          }
	        }
	      }
        }
        window.onload = function() {
            if (window.android) {
                hasLogin = android.isLogin();
            }
            if(hasLogin){
                query ();
            }
        }
        function isLogin(b) {
            hasLogin = b
            if(hasLogin){
                query ();
            }
        }

        function isiOS() {
            var u = navigator.userAgent;
            return !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
        }

        function back() {
	        if (!hasLogin) {
	            // 还没登录则先登录
	            if (location.href.indexOf('type=h5') != -1) {
		        	if ( parent && parent.closeIFrame ) {
			          parent.closeIFrame({action: 'goLogin'})
			        } else {
			          if ( location.search != '?goLogin') {
			            location.search = 'goLogin'
			          }
			        }
		      	} else {
		            if (isiOS()) {
		                //window.webkit.messageHandlers.goAppLogin.postMessage(null);
		                goAppLogin();
		            } else if (window.android) {
		                android.goAppLogin();
		            }
	            }
	            return;
	        }
	        if (location.href.indexOf('type=h5') != -1) {
	        	if ( parent && parent.closeIFrame ) {
		          parent.closeIFrame({action: 'goToLoad'})
		        }
	      	} else {
		        if (isiOS()) {
		            go('load');
		        } else if (window.android) {
		            android.go('load');
		        }
		    }
	        return;
	    }

	    $(document).on('click', '.draw', function(){
	    	var cid = $(this).attr("id");
	        draw (cid);
		});

        function query () {
	    	$.ajax({
			    url: "/Promos/Detail",
			    jsonp: "callback",
			    // dataType: "jsonp",
			    async: true,
			    data: { "id": "36","a": "Check" },    //参数值
			    type: "GET",   //请求方式
			    beforeSend: function() {
			        //请求前的处理
			    },
			    success: function(req) {
			    	var num = Number(req.data);
			    	if (req.state) {
			    		if( num <= 0){
			    			$('#draw').css('display','none');
			    			$('#topUp').css('display','block');
			    		}else{
			    			$('#topUp').css('display','none');
			    			$('#draw').css('display','block');
			    			$('.bonus').html(num);
			    		}
			    	}else{
			    		if ( req.message == '暂无奖金可领取' ) {
			    			$('#draw').css('display','none');
			    			$('#topUp').css('display','block');
			    		} else if ( req.message == 'login' ) {
		    			 	if (isiOS()) {
				                goAppLogin();
				            } else if (window.android) {
				                android.goAppLogin();
				            }
			    		} else{
			    			var popup = new Popup({
						        'type': 'submit',
						        'title': '提示信息',
						        'text': req.message
						    })
			    		}
			    	}
			    }
			});
		}

		function draw (cid) {
	    	$.ajax({
			    url: "/Promos/Detail",
			    jsonp: "callback",
			    // dataType: "jsonp",
			    async: true,
			    data: { "id": "36","a": "Claim","platId": cid },    //参数值
			    type: "GET",   //请求方式
			    beforeSend: function() {
			        //请求前的处理
			    },
			    success: function(req) {
			    	$('.mask').css('display','none');
			    	if (req.state) {
			    		var popup = new Popup({
					        'type': 'submit',
					        'title': '提示信息',
					        'text': req.data,
					        'submitCallBack': function(){
					        	query();
					        }
					    })
			    	}else{
			    		var popup = new Popup({
					        'type': 'submit',
					        'title': '提示信息',
					        'text': req.message
					    })
			    	}
			    }
			});
		}
	</script>
</body>
