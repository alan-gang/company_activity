<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>端午节</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/swiper.min.css">
    <link rel="stylesheet" type="text/css" href="css/popup.css">
	<link rel="stylesheet" type="text/css" href="css/dragonboat.css?v=2.0">
	<script type="text/javascript" src="js/fastclick.js"></script>
</head>

<body>
	<div class="wrapper w1">
		<div class="banner w1"></div>
		<div class="actTerm w1">
			<div class="titTitle title"></div>
			<div class="swiper-container">
			    <div class="swiper-wrapper">

					<div class="swiper-slide" id="s1">
						<img src="img/dragonboat/a1.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s2">
						<img src="img/dragonboat/a2.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s3">
						<img src="img/dragonboat/a3.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s4">
						<img src="img/dragonboat/a4.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s5">
						<img src="img/dragonboat/a5.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s6">
						<img src="img/dragonboat/a6.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s7">
						<img src="img/dragonboat/a7.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s8">
						<img src="img/dragonboat/a8.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s9">
						<img src="img/dragonboat/a9.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s10">
						<img src="img/dragonboat/a10.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s11">
						<img src="img/dragonboat/a11.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s12">
						<img src="img/dragonboat/a12.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>
					<div class="swiper-slide" id="s13">
						<img src="img/dragonboat/a13.png" alt="">
						<img class="finish" src="img/dragonboat/complete@3x.png" alt="">
					</div>

			    </div>
			    <!-- Add Arrows -->
			    <!-- <div class="swiper-button-next"></div>
			    <div class="swiper-button-prev"></div> -->
		  	</div>
			<div class="btn mat" id="draw">
				<a href="javascript:" title="领取奖励">
					<img src="img/dragonboat/btn1@2x.png" alt="">
				</a>
			</div>
			<div class="btn mat" id="undone">
				<a href="javascript:" title="未完成">
					<img src="img/dragonboat/btn1_@2x.png" alt="">
				</a>
			</div>
			<div class="btn mat" id="done">
				<a href="javascript:" title="已领取">
					<img src="img/dragonboat/btn1_2@2x.png" alt="">
				</a>
			</div>
			<div class="conTitle">
				<ul class="termList mat">
					<li>
						<i class="termIndex">1.</i>
						<p>
							活动期间每位用户每天可以参加一次闯关，完成三条随机任务即为闯关成功；
						</p>
					</li>
					<li>
						<i class="termIndex">2.</i>
						<p>
							闯关成功即可获得五芳斋粽子、现金红包、饰品等奖励，免费参加端午ROLL房抽奖活动；
						</p>
					</li>
				</ul>
			</div>
			<div class="listWrap mat">
				<ul class="termList mat">
					<li>
						<i class="termIndex">1.</i>
						<p>
							每日闯关活动系统随机发布三条任务，同时发布任务奖励，完成任务即可领取；
						</p>
					</li>
					<li>
						<i class="termIndex">2.</i>
						<p>
							任务完成后现金红包可在活动页面领取，实物奖品需联系客服领取；
						</p>
					</li>
					<li>
						<i class="termIndex">3.</i>
						<p>
							任务奖励中所有实物奖品均可折现，需完成一倍流水后进行提款；
						</p>
					</li>
					<li>
						<i class="termIndex">4.</i>
						<p>
							此活动每个玩家仅限每天参加一次，每日需要在00：00分之前领取,逾期视为放弃；
						</p>
					</li>
					<li>
						<i class="termIndex">5.</i>
						<p>
							每位会员（同姓名、同手机号、同IP等），仅限一个账号参与该活动;
						</p>
					</li>
					<li>
						<i class="termIndex">6.</i>
						<p>
							凡参加活动用户，即表示接受且自愿遵守平台规定，平台保留最终解释权；
						</p>
					</li>
					<li>活动时间：2019年6月1日 00:00:00 - 2019年6月7日 23:59:59</li>
				</ul>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript" src="js/popup.js"></script>
	<script src="js/swiper.min.js"></script>
	<script type="text/javascript">
		FastClick.attach(document.body);
	    var hasLogin = false;
        //h5登录
        if (location.href.indexOf('type=h5') != -1) {
            if (location.href.indexOf('hasLogin=true') != -1) {
              hasLogin = true;
              checkTask ();
            }else{
              if ( parent && parent.closeIFrame ) {
                parent.closeIFrame({action: 'goLogin'})
              } else {
                if ( location.search != '?goLogin') {
                  location.search = 'goLogin'
                }
              }
            }
        }
         //登录验证
        window.onload = function() {
          if (window.android) {
              hasLogin = android.isLogin();
              if(hasLogin){
                  checkTask ();
              }
          }
        }
        function isLogin(b) {
          hasLogin = b
          if(hasLogin){
              checkTask ();
          }
        }
        function isiOS() {
           var u = navigator.userAgent;
           return !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
        }
		// 领取
		$(document).on('click', '#draw', function(){
			$this = this;
			$($this).addClass('unable');
	        drawBonus();
     	});
		function checkTask () {
			$.ajax({
			    url: "/Promos/Detail",
			    jsonp: "callback",
			    // dataType: "jsonp",
			    async: true,
			    data: { "id": "52","a": "Check" },    //参数值
			    type: "GET",   //请求方式
			    beforeSend: function() {
			        //请求前的处理
			    },
			    success: function(req) {
			    	// console.log(req.data)
			    	if ( req.state ) {
			    		var plan = req.data.plan;
			    		if (req.data.state == 0) {
			    			$('#undone').css('display', 'block');
			    		} else if (req.data.state == 1) {
			    			$('#draw').css('display', 'block');
			    		} else {
			    			$('#done').css('display', 'block');
			    		}
			    		$.map( plan, function(v){
						    $("#s"+ v.id ).css('display', 'block');
						    if ( v.state == 1 ) {
						    	$("#s"+ v.id + " .finish").css('display', 'block');
						    }
						});
						var swiper = new Swiper('.swiper-container', {
					      slidesPerView: 1.8,
					      spaceBetween: 30,
					      pagination: {
					        el: '.swiper-pagination',
					        clickable: true,
					      }
					    });
			    	} else {
					    var popup = new Popup({
					        'type': 'submit',
					        'title': '信息',
					        'text': req.message
					    })
			    	}

				}
			});
		}
		function drawBonus () {
	    	$.ajax({
			    url: "/Promos/Detail",
			    jsonp: "callback",
			    // dataType: "jsonp",
			    async: true,
			    data: { "id": "52","a": "Claim" },    //参数值
			    type: "GET",   //请求方式
			    beforeSend: function() {
			        //请求前的处理
			    },
			    complete: function () {
		            $('#draw').removeClass('unable');
		        },
			    success: function(req) {
			    	// console.log(req.data)
			    	if ( req.state ) {
					    var popup = new Popup({
					        'type': 'submit',
					        'title': '信息',
					        'text': req.data,
					        'submitCallBack': function(){
								$('#draw').css('display', 'none');
								$('#done').css('display', 'block');
					      	},
					      	'closeCallBack': function(){
								$('#draw').css('display', 'none');
								$('#done').css('display', 'block');
					      	}
					    })
			    	} else {
					    var popup = new Popup({
					        'type': 'submit',
					        'title': '信息',
					        'text': req.message
					    })
			    	}

			    }
			});
		}
	</script>
</body>
